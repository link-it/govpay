var REST_SERVER=location.protocol+'//'+location.hostname+(location.port ? ':'+location.port: ''),BASE_URL=location.pathname,LOGIN_URL=BASE_URL,REST_URL=REST_SERVER+BASE_URL+"rs",MENU_URL=REST_URL+"/dars/",USER_INFO_URL=REST_URL+"/dars/operatori/user";!function(e){"use strict";var o=e.querySelector("#app");o.USER_LOGGED=null,o.ADVANCED_MODE=!1,o.numSpinner=0,o.LANGUAGE="it",o.RESOURCES={},o.baseUrl="/",""===window.location.port,o.openDrawer=function(e){this.$.drawerPanel.openDrawer()},o.closeDrawer=function(e){this.$.drawerPanel.closeDrawer()},o.scrollPageToTop=function(){},o.showSpinner=function(){o.numSpinner++,this.$.spinner.setSpinner(!0)},o.hideSpinner=function(){o.numSpinner--,0==o.numSpinner&&this.$.spinner.setSpinner(!1)},o.showPaperToast=function(e,o){this.$.toast.toggleClass("fit-bottom",!1),this.$.toast.toggleClass("success",!1),this.$.toast.toggleClass("error",!1),this.$.toast.toggleClass("warning",!1),o&&(this.$.toast.toggleClass(o,!0),this.$.toast.toggleClass("fit-bottom",!0)),Polymer.updateStyles(),this.$.toast.text=e,this.$.toast.show()},o.displayInstalledToast=function(){Polymer.dom(e).querySelector("platinum-sw-cache").disabled||Polymer.dom(e).querySelector("#caching-complete").show()},o.addEventListener("dom-change",function(){console.log("Our app is ready to rock!"),o.getUserInfo()}),window.addEventListener("WebComponentsReady",function(){}),o.getUserInfo=function(){this.$.getUserInfo.url=USER_INFO_URL,this.$.getUserInfo.generateRequest()},o.getUserInfo_responseHandler=function(e){var n=e.detail.response;switch(console.log(e),n.esitoOperazione){case"ESEGUITA":o.USER_LOGGED=e.detail.response.response,o.getConsoleInfo();break;case"NONESEGUITA":window.location=o.getDoLogoutURL();break;case"ERRORE":window.location=o.getDoLogoutURL()}},o.getUserInfo_errorHandler=function(e){this.dars_errorHandler(e)},o.getConsoleInfo=function(){this.$.getConsoleInfo.url=MENU_URL,this.$.getConsoleInfo.generateRequest()},o.getConsoleURL=function(){return REST_URL},o.getLoginURL=function(){return REST_SERVER+BASE_URL+"/"},o.getLogoutOkURL=function(){return REST_SERVER+BASE_URL+"/?msg=lo"},o.getNonAutorizzatoURL=function(){return REST_SERVER+BASE_URL+"/?msg=na"},o.getSessioneScadutaURL=function(){return REST_SERVER+BASE_URL+"/?msg=se"},o.getDoLogoutURL=function(){return REST_SERVER+BASE_URL+"/logout?msg=er"},o.getConsoleInfo_responseHandler=function(n){var t="";n.detail.response.response.menu.home?(this.$.mainModule.title=n.detail.response.response.menu.home.label,this.$.mainModule.resource=n.detail.response.response.menu.home.uri,t=n.detail.response.response.menu.home.uri):this.$.mainModule.title=n.detail.response.response.titolo,n.detail.response.response.lingue&&(o.RESOURCES=n.detail.response.response.lingue,e.dispatchEvent(new CustomEvent("change-language")));for(var s=0;s<n.detail.response.response.menu.sezioni.length;s++){var r=n.detail.response.response.menu.sezioni[s];r.vociMenu&&r.vociMenu.length>0?(r.haVoci=!0,r.opened=!1):(r.haVoci=!1,r.opened=!1);for(var i=0;i<r.vociMenu.length;i++){var a=r.vociMenu[i];a.uri==t&&(r.opened=!0,r.selected=i)}}o.consoleInfo=n.detail.response.response},o.getConsoleInfo_errorHandler=function(e){this.dars_errorHandler(e)},o.toggleMenu=function(e){for(var n=e.model.index,t=0;t<o.consoleInfo.menu.sezioni.length;t++){o.consoleInfo.menu.sezioni[t];t==n?o.set("consoleInfo.menu.sezioni."+t+".opened",!e.model.item.opened):o.set("consoleInfo.menu.sezioni."+t+".opened",!1)}},o.loadModule=function(e){this.$.mainModule.title=e.target.dataItem.label,this.$.mainModule.resource=e.target.dataItem.uri,o.closeDrawer()},o.dars_errorHandler=function(e){o.showPaperToast("Errore","error");var n=e.detail.request.status;401==n?window.location=o.getNonAutorizzatoURL():403==n?window.location=o.getSessioneScadutaURL():500==n&&(window.location=o.getDoLogoutURL())},o.appendLangParameter=function(e){var n=e.indexOf("?")>-1?"&":"?";return n+"lang="+o.LANGUAGE}}(document);